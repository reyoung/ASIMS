require(["admin/active","field_checker"],function(e,f){e("nav_news_create");$(function(){function d(a){a.preventDefault();a=$(this).attr("data-id");console.log("Del Btn Clicked "+a);a="http://"+location.host+"/admin/Attachment/"+a;$.ajaxSetup({type:"DELETE",async:!1});"false"!=$.ajax({url:a}).responseText&&$(this).parent().parent().remove()}$(".form-horizontal").submit(function(){var a=[];$(".attachment-del-btn").each(function(){a.push(parseInt($(this).attr("data-id"),10))});$("#files_id").val(JSON.stringify(a));
return!0});$(".attachment-del-btn").click(d);swfu=new SWFUpload({upload_url:"http://"+location.host+"/admin/Attachment/upload",flash_url:"http://"+location.host+SWF_URL,file_size_limit:"20MB",button_width:"63",button_height:"21",button_image_url:BTN_IMG,button_placeholder_id:"spanSWFUploadButton",button_text:'<span class="theFont">上传</span>',button_text_style:".theFont { font-size: 12; }",button_text_left_padding:12,button_text_top_padding:3,upload_start_handler:function(a){a="<tr id='r"+a.id+"'><td>"+
a.name+"</td><td>上传中</td></tr>";console.log(a);$("#AttachmentTHead").html("<tr><th>文件名</th><th>操作</th></tr>");$("#AttachmentTBody").append(a);return!0}});swfu.fileQueued=function(a){console.log(a);swfu.startUpload(a.id);return!0};swfu.uploadError=function(a,b,c){console.log("On Upload Error "+b+" "+c);return!0};swfu.uploadProgress=function(a,b,c){$("#progressbar").attr("style","width: "+100*b/c+"%;");return!0};swfu.uploadSuccess=function(a,b,c){b=JSON.parse(b);$("#r"+a.id).remove();a="<tr id='r"+
a.id+"'><td>"+a.name+"</td><td><button class='attachment-del-btn btn btn-danger' data-id='"+b+"'>删除</button></td></tr>";$("#AttachmentTBody").append(a);$(".attachment-del-btn").click(d);return!0};swfu.fileQueueError=function(a,b,c){b===SWFUpload.QUEUE_ERROR.FILE_EXCEEDS_SIZE_LIMIT&&alert("请选择小于20MB的文件")}})});
